<!DOCTYPE html>
<html>
<head>
  <title>Applescript, Omnifocus & Transmit</title>
  <meta content='Bizzark is a Scottsdale Arizona based website design and development company.' name='description'>
  <meta content='website development, arizona website development, arizona web developer, arizona web development company' name='keywords'>
  <link href='http://www.bizzark.com/blog.xml' rel='alternate' title='Bizzark Blog Feed' type='application/rss+xml'>
  <link href='/favicon.png' rel='icon' type='image/png'>

  <link rel="stylesheet" href="/css/main.css">

  <script>
   var styleNode = document.createElement('style');
   styleNode.type = "text/css";
   css = "body{ background: #d5d5d5 url(\"/images/bg" + (Math.floor((Math.random()*4)+1)) +".png\") no-repeat top left; background-attachment:fixed;}";
   

   // browser detection (based on prototype.js)
   if(!!(window.attachEvent && !window.opera)) {
      styleNode.styleSheet.cssText = css;
   } else {
      var styleText = document.createTextNode(css);
      styleNode.appendChild(styleText);
   }
   document.getElementsByTagName('head')[0].appendChild(styleNode);
  </script>

  <script src='//use.typekit.net/ztt1pbp.js' type='text/javascript'></script>
  <script>
    //<![CDATA[
      try{Typekit.load();}catch(e){}
    //]]>
  </script>
</head>

<body class=''>
  <div id='bg'></div>
  <div id='bgoverlay'></div>
  <div id='container'>
        <div id='header'>
      <div id='words'>
        <h1>RUBY HTML WWW</h1>
        <h2>ZEROS AND ONES FROM BRENT WEJROWSKI</h2>
      </div>
      <div id='logo'><h1><a href="/">BIZZARK</a></h1></div>
      <div id='nav'>
        <h1 class='nav '><a href="/">BLOG</a></h1>
        <h1 class='nav '><a href="/about.html">ABOUT</a></h1>
      </div>
    </div><!--/#header-->

    <div id='content'>
      <h1 class="header-banner">Applescript, Omnifocus & Transmit</h1>
<div class="top-back">
  <a href="/">&larr; Back to Blogs</a>
</div>
<div class="post-date">
  6 February 2011
</div>
<p>
    I&#39;ve been using <a href="http://www.omnigroup.com/products/omnifocus" target="_blank">Omnifocus</a> now for about 3 months, after struggling to find a good system to keep track of what I&#39;m doing. It&#39;s pretty perfect. Except for one thing.&nbsp;It&#39;s not web based, and the only mobile app it has is for the iPhone. So I can&#39;t access anything on my lists unless I have my computer with me. So, I was daydreaming one day and wondering how I could take a list, and put it online so I could (for instance) go to the grocery store and see exactly what I need to get, and mark off what I put in my cart. Sure I could print it off, but sometimes I can&#39;t do that. And sure, I could use their HTML export, but they don&#39;t have check boxes on them so I can&#39;t check off what I&#39;ve done.</p>

<p>
    So long story short, I instead decided to spend a good 4 hours, learn a bit of&nbsp;<a href="http://developer.apple.com/AppleScript/" target="_blank">Applescript</a>, and create a nifty Applescript&nbsp;which exports an Omnifocus list to custom html with check boxes next to each item (<a href="http://www.brentwejrowski.com/omni/omni.html" target="_blank">see an example here</a>), and automatically uploads it via FTP in <a href="http://www.panic.com/transmit/" target="_blank">Transmit</a>... all in the click of a button.</p>

<p>
    Anyways, for anyone who could actually make use of this, here&#39;s what I&#39;ve got:</p>

<div class="code">
    on run<br />
    &nbsp;&nbsp;&nbsp;&nbsp;tell application id &quot;com.omnigroup.OmniFocus&quot; to tell default document<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set PP to project &quot;Grocery Print list&quot; in folder &quot;Personal&quot;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set pptasks to every task of PP where completed is false<br />
    &nbsp;&nbsp;&nbsp;&nbsp;end tell<br />
    &nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;set f to ((path to desktop as text) &amp; &quot;omni.html&quot;)<br />
    &nbsp;&nbsp;&nbsp;&nbsp;set nref to open for access file f with write permission<br />
    &nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;write &quot;<br />
    &lt;html&gt;<br />
    &lt;head&gt;<br />
    &lt;title&gt;Omnifocus export - &quot; &amp; (current date) &amp; &quot; &lt;/title&gt;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;link href=&#39;style.css&#39; media=&#39;screen&#39; rel=&#39;stylesheet&#39; type=&#39;text/css&#39; /&gt;<br />
    &lt;/head&gt;<br />
    &lt;body&gt;<br />
    &lt;div id=&#39;container&#39;&gt;<br />
    &lt;div class=&#39;title&#39;&gt;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Omnifocus Applescript Export&lt;/h1&gt;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&quot; &amp; (current date) &amp; &quot;<br />
    &lt;/div&gt;<br />
    &lt;ul&gt;&quot; to file f<br />
    &nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;repeat with ot in pptasks<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set testVars to name of ot<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write &quot;&lt;li&gt;&lt;label&gt;&lt;input type=&#39;checkbox&#39; /&gt;&quot; &amp; testVars &amp; &quot;&lt;/label&gt;&lt;/li&gt;&quot; to file f<br />
    &nbsp;&nbsp;&nbsp;&nbsp;end repeat<br />
    &nbsp;&nbsp;&nbsp;&nbsp;write &quot;<br />
    &lt;/ul&gt;<br />
    &nbsp;&nbsp;&nbsp;&nbsp; &lt;/div&gt;<br />
    &lt;/body&gt;<br />
    &lt;/html&gt;&quot; to file f<br />
    &nbsp;&nbsp;&nbsp;&nbsp;close access nref<br />
    &nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;tell application &quot;Transmit&quot;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set myFave to item 1 of (favorites whose name is &quot;Brentwejrowski.com&quot;)<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set myRules to (skip rules whose name is &quot;New Rule&quot;)<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tell current tab of (make new document at end)<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect to myFave<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tell local browser<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change location to path &quot;~/Desktop&quot;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end tell<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tell remote browser<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upload item at path &quot;~/Desktop/omni4.html&quot; to &quot;public_html/omni&quot; with resume mode overwrite<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end tell<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close remote browser<br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end tell<br />
    &nbsp;&nbsp;&nbsp;&nbsp;end tell<br />
    end run</div>


  <div class="post-footer">
    <div class="comments-num"><a href="/<%= @page.slug %>#disqus_thread">Comments (View)</a></div>
  </div>

  <div id="disqus_thread"></div>
  <script type="text/javascript">
    function getDisqusEmbed(){
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = 'http://bizzark-web-development.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    } (function() {
      setTimeout("getDisqusEmbed()", 50);  
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=bizzark-web-development">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

    </div><!--/#content-->
  </div><!--/container-->

<script>
  //<![CDATA[
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  //]]>
</script>
<script>
  //<![CDATA[
    try{ var pageTracker = _gat._getTracker("UA-5643858-1"); pageTracker._trackPageview(); } catch(err) {}
  //]]>
</script>

</body>
</html>
